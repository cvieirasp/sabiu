# Issues para o Projeto SABIU

## Milestone 1: Autenticação e Infraestrutura (6 issues)

### Issue #1: Configurar NextAuth com Prisma Adapter

**Labels:** `feature`, `auth`, `priority: high`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Configurar NextAuth.js v4 para autenticação de usuários usando o Prisma Adapter.

**Tasks:**

- [ ] Criar arquivo `src/lib/auth.ts` com configuração do NextAuth
- [ ] Configurar Prisma Adapter
- [ ] Adicionar provider Credentials (email/senha)
- [ ] Configurar session strategy (JWT)
- [ ] Testar autenticação básica

**Critérios de Aceitação:**

- NextAuth configurado e funcional
- Usuário pode fazer login com email/senha
- Sessão persiste corretamente

---

### Issue #2: Implementar página de cadastro (sign-up)

**Labels:** `feature`, `auth`, `ui`, `priority: high`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Criar página de cadastro de novos usuários com validação.

**Tasks:**

- [ ] Criar rota `src/app/(auth)/sign-up/page.tsx`
- [ ] Criar schema Zod para validação (nome, email, senha)
- [ ] Implementar formulário com react-hook-form
- [ ] Criar API route `POST /api/auth/register`
- [ ] Hash de senha com bcryptjs
- [ ] Tratamento de erros (email duplicado, etc)
- [ ] Adicionar feedback visual (loading, success, error)

**Critérios de Aceitação:**

- Formulário de cadastro funcional e responsivo
- Validação client-side e server-side
- Senhas hashadas antes de salvar
- Redirecionamento após cadastro bem-sucedido

---

### Issue #3: Implementar página de login (sign-in)

**Labels:** `feature`, `auth`, `ui`, `priority: high`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Criar página de login para usuários existentes.

**Tasks:**

- [ ] Criar rota `src/app/(auth)/sign-in/page.tsx`
- [ ] Criar schema Zod para validação
- [ ] Implementar formulário com react-hook-form
- [ ] Integrar com NextAuth signIn()
- [ ] Tratamento de erros (credenciais inválidas)
- [ ] Link para página de cadastro
- [ ] Link para reset de senha
- [ ] Adicionar feedback visual

**Critérios de Aceitação:**

- Formulário de login funcional
- Autenticação com credenciais válidas
- Mensagens de erro claras
- Redirecionamento para dashboard após login

---

### Issue #4: Implementar reset de senha com Resend

**Labels:** `feature`, `auth`, `email`, `priority: medium`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Implementar fluxo completo de recuperação de senha via email.

**Tasks:**

- [ ] Criar página `src/app/(auth)/reset-password/page.tsx`
- [ ] Criar API route `POST /api/auth/reset/request`
- [ ] Gerar token único e temporário (15 min)
- [ ] Salvar token no banco (VerificationToken)
- [ ] Configurar Resend e criar template de email
- [ ] Enviar email com link de reset
- [ ] Criar página de confirmação com token
- [ ] Criar API route `POST /api/auth/reset/confirm`
- [ ] Validar token e atualizar senha
- [ ] Invalidar token após uso

**Critérios de Aceitação:**

- Usuário recebe email com link válido
- Token expira em 15 minutos
- Senha atualizada com sucesso
- Token não pode ser reutilizado

---

### Issue #5: Criar middleware de autenticação

**Labels:** `feature`, `auth`, `priority: high`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Implementar middleware para proteger rotas autenticadas.

**Tasks:**

- [ ] Criar `src/middleware.ts`
- [ ] Verificar sessão do NextAuth
- [ ] Redirecionar usuários não autenticados para /sign-in
- [ ] Permitir acesso a rotas públicas (/sign-in, /sign-up)
- [ ] Adicionar matcher para rotas (protected)

**Critérios de Aceitação:**

- Rotas protegidas só acessíveis com autenticação
- Redirecionamento automático para login
- Rotas públicas sempre acessíveis

---

### Issue #6: Criar providers (QueryClient, Theme, Auth)

**Labels:** `feature`, `infra`, `priority: high`
**Milestone:** Autenticação e Infraestrutura

**Descrição:**
Configurar providers globais da aplicação.

**Tasks:**

- [ ] Criar `src/components/providers/query-provider.tsx`
- [ ] Criar `src/components/providers/theme-provider.tsx`
- [ ] Criar `src/components/providers/auth-provider.tsx`
- [ ] Configurar React Query com defaults
- [ ] Configurar next-themes
- [ ] Adicionar SessionProvider do NextAuth
- [ ] Integrar todos os providers no layout root

**Critérios de Aceitação:**

- React Query funcionando globalmente
- Alternância de tema funcionando
- Sessão acessível em todos os componentes

---

## Milestone 2: Core - Entidades e Use Cases (4 issues)

### Issue #1: Implementar entidades do domínio

**Labels:** `feature`, `core`, `priority: high`
**Milestone:** Core - Entidades e Use Cases

**Descrição:**
Criar classes de entidades seguindo Clean Architecture.

**Tasks:**

- [ ] Criar `src/core/entities/User.ts`
- [ ] Criar `src/core/entities/LearningItem.ts`
- [ ] Criar `src/core/entities/Module.ts`
- [ ] Criar `src/core/entities/Category.ts`
- [ ] Criar `src/core/entities/Tag.ts`
- [ ] Criar `src/core/entities/Dependency.ts`
- [ ] Adicionar validações de regras de negócio
- [ ] Adicionar métodos de domínio (ex: calculateProgress)

**Critérios de Aceitação:**

- Entidades representam corretamente o domínio
- Validações implementadas
- Métodos de negócio funcionais

---

### Issue #2: Criar interfaces de repositórios

**Labels:** `feature`, `core`, `priority: high`
**Milestone:** Core - Entidades e Use Cases

**Descrição:**
Definir contratos (interfaces) para acesso a dados.

**Tasks:**

- [ ] Criar `src/core/interfaces/UserRepository.ts`
- [ ] Criar `src/core/interfaces/LearningItemRepository.ts`
- [ ] Criar `src/core/interfaces/ModuleRepository.ts`
- [ ] Criar `src/core/interfaces/CategoryRepository.ts`
- [ ] Criar `src/core/interfaces/TagRepository.ts`
- [ ] Criar `src/core/interfaces/DependencyRepository.ts`
- [ ] Definir métodos CRUD e consultas específicas

**Critérios de Aceitação:**

- Interfaces bem definidas
- Métodos cobrem todas as necessidades
- Documentação de parâmetros e retornos

---

### Issue #3: Implementar use cases principais

**Labels:** `feature`, `core`, `priority: high`
**Milestone:** Core - Entidades e Use Cases

**Descrição:**
Criar casos de uso com lógica de negócio.

**Tasks:**

- [ ] Criar `src/core/use-cases/CreateLearningItem.ts`
- [ ] Criar `src/core/use-cases/UpdateLearningItem.ts`
- [ ] Criar `src/core/use-cases/DeleteLearningItem.ts`
- [ ] Criar `src/core/use-cases/CalculateProgress.ts`
- [ ] Criar `src/core/use-cases/LinkDependency.ts`
- [ ] Criar `src/core/use-cases/GetDashboardMetrics.ts`
- [ ] Implementar testes unitários para use cases

**Critérios de Aceitação:**

- Use cases independentes de framework
- Lógica de negócio isolada
- Testes unitários passando

---

### Issue #4: Criar DTOs e mappers

**Labels:** `feature`, `core`, `priority: medium`
**Milestone:** Core - Entidades e Use Cases

**Descrição:**
Implementar Data Transfer Objects e conversores.

**Tasks:**

- [ ] Criar DTOs em `src/core/dtos/`
- [ ] Criar mappers em `src/infra/mappers/`
- [ ] Implementar conversão DTO → Entity
- [ ] Implementar conversão Entity → DTO
- [ ] Implementar conversão Prisma Model → Entity

**Critérios de Aceitação:**

- DTOs bem tipados
- Mappers bidirecionais funcionando
- Conversão sem perda de dados

---

## Milestone 3: CRUD de Itens de Aprendizado (5 issues)

### Issue #11: Implementar API routes para Items

**Labels:** `feature`, `api`, `priority: high`
**Milestone:** CRUD de Itens de Aprendizado

**Descrição:**
Criar rotas REST para gerenciar itens de aprendizado.

**Tasks:**

- [ ] Criar `src/app/api/items/route.ts` (GET, POST)
- [ ] Criar `src/app/api/items/[id]/route.ts` (GET, PUT, DELETE)
- [ ] Criar schemas Zod para validação
- [ ] Implementar repositories Prisma
- [ ] Integrar com use cases
- [ ] Adicionar paginação no GET
- [ ] Adicionar filtros (status, category, tags)
- [ ] Tratamento de erros consistente
- [ ] Adicionar testes de integração

**Critérios de Aceitação:**

- Todas as operações CRUD funcionando
- Validação de entrada
- Resposta padronizada
- Erros tratados corretamente

---

### Issue #12: Criar formulário de Item com Markdown

**Labels:** `feature`, `ui`, `forms`, `priority: high`
**Milestone:** CRUD de Itens de Aprendizado

**Descrição:**
Implementar formulário completo de criação/edição de itens.

**Tasks:**

- [ ] Criar componente `ItemForm.tsx`
- [ ] Configurar react-hook-form + Zod
- [ ] Campo de título (input)
- [ ] Campo de descrição com Markdown (textarea)
- [ ] Preview do Markdown em tempo real
- [ ] Seletor de categoria
- [ ] Campo de prazo (date picker)
- [ ] Seletor de status
- [ ] Campo de tags (multi-select)
- [ ] Validação visual de erros
- [ ] Loading states

**Critérios de Aceitação:**

- Formulário responsivo e acessível
- Preview Markdown funcionando
- Validação em tempo real
- Experiência fluida

---

### Issue #13: Implementar gestão de módulos

**Labels:** `feature`, `ui`, `priority: high`
**Milestone:** CRUD de Itens de Aprendizado

**Descrição:**
Criar interface para adicionar/editar/remover módulos de um item.

**Tasks:**

- [ ] Criar componente `ModulesEditor.tsx`
- [ ] Lista de módulos com ordenação
- [ ] Adicionar novo módulo (inline)
- [ ] Editar módulo existente
- [ ] Remover módulo com confirmação
- [ ] Drag-and-drop para reordenar (opcional)
- [ ] Atualizar status do módulo
- [ ] Calcular progresso automaticamente

**Critérios de Aceitação:**

- CRUD de módulos funcionando
- Progresso calculado corretamente
- Interface intuitiva

---

### Issue #14: Implementar sistema de dependências

**Labels:** `feature`, `ui`, `priority: medium`
**Milestone:** CRUD de Itens de Aprendizado

**Descrição:**
Criar interface para vincular pré-requisitos entre itens.

**Tasks:**

- [ ] Criar componente `DependenciesPicker.tsx`
- [ ] Busca de itens disponíveis
- [ ] Multi-select de itens
- [ ] Visualização de dependências atuais
- [ ] Remover dependência
- [ ] Validar dependências circulares
- [ ] API routes para dependências

**Critérios de Aceitação:**

- Adicionar/remover dependências
- Não permitir ciclos
- Interface clara

---

### Issue #15: Criar página de listagem com filtros

**Labels:** `feature`, `ui`, `priority: high`
**Milestone:** CRUD de Itens de Aprendizado

**Descrição:**
Implementar página de lista de itens com filtros e ordenação.

**Tasks:**

- [ ] Criar `src/app/(protected)/items/page.tsx`
- [ ] Criar componente `ItemsTable.tsx`
- [ ] Implementar filtros (status, categoria, tags, texto)
- [ ] Implementar ordenação (título, data, progresso, prazo)
- [ ] Implementar paginação
- [ ] Ações por item (ver, editar, deletar)
- [ ] Empty state quando sem itens
- [ ] Loading state com skeleton
- [ ] Integrar com React Query

**Critérios de Aceitação:**

- Lista responsiva e performática
- Filtros funcionando
- Ordenação funcionando
- Paginação funcionando

---

## Milestone 4: Visualizações (3 issues)

### Issue #16: Implementar Dashboard com KPIs

**Labels:** `feature`, `ui`, `dashboard`, `priority: high`
**Milestone:** Visualizações

**Descrição:**
Criar dashboard inicial com métricas e gráficos.

**Tasks:**

- [ ] Criar `src/app/(protected)/dashboard/page.tsx`
- [ ] Card: Total por categoria (donut chart)
- [ ] Card: Total por status (bar chart)
- [ ] Card: Progresso médio geral
- [ ] Card: Top 5 itens próximos de concluir
- [ ] Lista de recentes atualizados
- [ ] CTA para criar novo item
- [ ] API route para métricas
- [ ] Usar Recharts ou similar para gráficos

**Critérios de Aceitação:**

- Dashboard informativo e visual
- Métricas corretas
- Performance adequada

---

### Issue #17: Criar Kanban Board com drag-and-drop

**Labels:** `feature`, `ui`, `kanban`, `priority: high`
**Milestone:** Visualizações

**Descrição:**
Implementar visualização Kanban com @dnd-kit.

**Tasks:**

- [ ] Criar `src/app/(protected)/kanban/page.tsx`
- [ ] Criar componente `KanbanBoard.tsx`
- [ ] Criar colunas: Backlog, Em Andamento, Pausado, Concluído
- [ ] Criar card de item (título, categoria, progresso, prazo)
- [ ] Implementar drag-and-drop entre colunas
- [ ] Atualizar status ao mover card
- [ ] Otimistic updates
- [ ] Acessibilidade (keyboard navigation)
- [ ] Loading states

**Critérios de Aceitação:**

- Kanban visual e funcional
- Drag-and-drop suave
- Status atualiza corretamente
- Acessível via teclado

---

### Issue #18: Implementar Fluxograma com React Flow

**Labels:** `feature`, `ui`, `graph`, `priority: medium`
**Milestone:** Visualizações

**Descrição:**
Criar visualização de grafo de dependências.

**Tasks:**

- [ ] Criar `src/app/(protected)/graph/page.tsx`
- [ ] Criar componente `DependencyGraph.tsx`
- [ ] Configurar React Flow
- [ ] Nós customizados (item, categoria, status, progresso)
- [ ] Arestas direcionadas (A depende de B)
- [ ] Layout automático (Dagre)
- [ ] Zoom e pan
- [ ] Seleção de nó mostra detalhes (sidebar)
- [ ] Filtros (categoria, status)
- [ ] Empty state quando sem dependências

**Critérios de Aceitação:**

- Grafo claro e navegável
- Layout organizado
- Detalhes acessíveis
- Performance adequada

---

## Milestone 5: Refinamentos (5 issues)

### Issue #19: Implementar upload de certificados

**Labels:** `feature`, `upload`, `priority: low`
**Milestone:** Refinamentos

**Descrição:**
Adicionar funcionalidade de upload de arquivos com UploadThing.

**Tasks:**

- [ ] Configurar UploadThing
- [ ] Criar API route do UploadThing
- [ ] Adicionar campo de upload no formulário
- [ ] Suporte a PDF, JPG, PNG
- [ ] Preview de arquivos
- [ ] Remover arquivo
- [ ] Associar arquivo ao item
- [ ] Exibir certificados na página de detalhes

**Critérios de Aceitação:**

- Upload funcionando
- Arquivos associados corretamente
- Preview funcional

---

### Issue #20: Criar sistema de categorias e tags

**Labels:** `feature`, `ui`, `priority: medium`
**Milestone:** Refinamentos

**Descrição:**
Interface para gerenciar categorias e tags.

**Tasks:**

- [ ] Criar página de categorias
- [ ] CRUD de categorias (nome, cor)
- [ ] Color picker para categorias
- [ ] Criar página de tags
- [ ] CRUD de tags
- [ ] API routes correspondentes

**Critérios de Aceitação:**

- Gerenciamento de categorias funcional
- Gerenciamento de tags funcional
- Cores aplicadas corretamente

---

### Issue #21: Adicionar notificações

**Labels:** `feature`, `ui`, `priority: low`
**Milestone:** Refinamentos

**Descrição:**
Sistema de notificações toast para feedback.

**Tasks:**

- [ ] Escolher lib de toast (sonner, react-hot-toast)
- [ ] Criar ToastProvider
- [ ] Notificações de sucesso
- [ ] Notificações de erro
- [ ] Notificações de info
- [ ] Aplicar em todas as operações

**Critérios de Aceitação:**

- Notificações visuais claras
- Feedback em todas as ações
- Acessível

---

### Issue #22: Testes unitários

**Labels:** `testing`, `priority: medium`
**Milestone:** Refinamentos

**Descrição:**
Escrever testes unitários para componentes e use cases.

**Tasks:**

- [ ] Configurar Vitest + Testing Library
- [ ] Testar entidades do core
- [ ] Testar use cases
- [ ] Testar componentes críticos (ItemForm, ModulesEditor)
- [ ] Testar mappers
- [ ] Atingir cobertura >70%

**Critérios de Aceitação:**

- Testes passando
- Cobertura adequada
- Testes mantíveis

---

### Issue #23: Testes de integração

**Labels:** `testing`, `priority: low`
**Milestone:** Refinamentos

**Descrição:**
Escrever testes de integração para API routes.

**Tasks:**

- [ ] Configurar banco de testes
- [ ] Testar rotas de autenticação
- [ ] Testar rotas de items
- [ ] Testar rotas de módulos
- [ ] Testar rotas de dependências
- [ ] Setup/teardown automático

**Critérios de Aceitação:**

- Testes de API funcionando
- Isolamento de testes
- Testes confiáveis

---

**Total: 23 Issues organizadas em 5 Milestones**
